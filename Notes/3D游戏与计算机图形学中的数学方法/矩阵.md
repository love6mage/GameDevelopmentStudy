# 矩阵

## 矩阵性质

- 一个 $n\times m$ 矩阵 $M$ 是由 $n$ 行 $m$ 列数字组成的数组，如果 $n=m$，则称矩阵 $M$ 为方阵，$M_{ij}$ 表示矩阵 $M$ 第 $i$ 行第 $j$ 列元素

  $$
  M=\begin{bmatrix}
  M_{11} & M_{12} & \dots & M_{1m} \\
  M_{21} & M_{22} & \dots & M_{2m} \\
  \vdots & \vdots & \ddots & \vdots \\
  M_{n1} & M_{n2} & \dots & M_{nm}
  \end{bmatrix}
  $$

- 矩阵中下标 $i=j$ 的元素称为主对角元素，只有主对角元素不等于零的方阵称为对角矩阵
- 一个 $n\times m$ 矩阵 $M$ 的转置矩阵表示为 $M^T$，是一个 $m\times n$ 矩阵

  $$
  M^T_{ij}=M_{ji}
  $$
  $$
  M^T=\begin{bmatrix}
  M_{11} & M_{21} & \dots & M_{n1} \\
  M_{12} & M_{22} & \dots & M_{n2} \\
  \vdots & \vdots & \ddots & \vdots \\
  M_{1m} & M_{2m} & \dots & M_{nm}
  \end{bmatrix}
  $$

- 标量 $a$ 和矩阵 $M$ 的乘积

  $$
  aM=Ma=\begin{bmatrix}
  aM_{11} & aM_{12} & \dots & aM_{1m} \\
  aM_{21} & aM_{22} & \dots & aM_{2m} \\
  \vdots & \vdots & \ddots & \vdots \\
  aM_{n1} & aM_{n2} & \dots & aM_{nm}
  \end{bmatrix}
  $$

- 两个 $n\times m$ 矩阵 $F$ 和 $G$ 的和

  $$
  F+G=\begin{bmatrix}
  F_{11}+G_{11} & F_{12}+G_{12} & \dots & F_{1m}+G_{1m} \\
  F_{21}+G_{21} & F_{22}+G_{22} & \dots & F_{2m}+G_{2m} \\
  \vdots & \vdots & \ddots & \vdots \\
  F_{n1}+G_{n1} & F_{n2}+G_{n2} & \dots & F_{nm}+G_{nm}
  \end{bmatrix}
  $$

- 当矩阵 $F$ 的列数等于矩阵 $G$ 的行数时，这两个矩阵可以相乘，即如果矩阵 $F$ 是 $n\times m$ 矩阵，矩阵 $G$ 是 $m\times p$ 矩阵，则这两个矩阵的乘积 $FG$ 是一个 $n\times p$ 矩阵，其中的 $(i,j)$ 元素等于

  $$
  (FG)_{ij}=\sum_{k=1}^mF_{ik}G_{kj}
  $$

  - 矩阵 $FG$ 的 $(i,j)$ 元素也可以看成矩阵 $F$ 的第 $i$ 行和矩阵 $G$ 的第 $j$ 列对应向量的内积
- 单位矩阵是一个 $n\times n$ 矩阵，可表示为 $I_n$ 或 $I$，对于任意 $n\times n$ 矩阵 $M$，$MI_n=I_nM=M$

  $$
  I_n=\begin{bmatrix}
  1 & 0 & \dots & 0 \\
  0 & 1 & \dots & 0 \\
  \vdots & \vdots & \ddots & \vdots \\
  0 & 0 & \dots & 1
  \end{bmatrix}
  $$
- **定理 1**：给定两个标量 $a$ 和 $b$，任意三个 $n\times n$ 矩阵 $F$、$G$ 和 $H$，以下矩阵性质成立
  - $F+G=G+F$
  - $(F+G)+H=F+(G+H)$
  - $a(bF)=(ab)F$
  - $a(F+G)=aF+aG$
  - $(a+b)F=aF+bF$
- **定理 2**：给定任意标量 $a$，任意一个 $n\times m$ 矩阵 $F$、一个 $m\times p$ 矩阵 $G$ 和一个 $p\times q$ 矩阵 $H$，以下矩阵性质成立
  - $(aF)G=a(FG)$
  - $(FG)H=F(GH)$
  - $(FG)^T=G^TF^T$

## 线性方程组

- 线性方程组可以使用矩阵紧凑方便地表示，未知数向量前面的矩阵称为系数矩阵，等号右边的矩阵称为常数向量

  $$
  \begin{cases}
  a_1x+b_1y+c_1z=d_1 \\
  a_2x+b_2y+c_2z=d_2 \\
  a_3x+b_3y+c_3z=d_3
  \end{cases} \\
  $$
  $$
  \begin{bmatrix}
  a_1 & b_1 & c_1 \\
  a_2 & b_2 & c_2 \\
  a_3 & b_3 & c_3
  \end{bmatrix}
  \begin{bmatrix}
  x \\ y \\ z 
  \end{bmatrix}=
  \begin{bmatrix}
  d_1 \\ d_2 \\ d_3 
  \end{bmatrix}
  $$

- 常数向量不为零向量的线性方程组为非齐次线性方程组；常数向量为零向量的线性方程组为齐次线性方程组
- 对系数矩阵和常数向量组成的增广矩阵进行初等行变换，使系数矩阵变成简约矩阵，可以计算出线性方程组的解
- **定义 3**：初等行变换是指对矩阵执行的以下三个操作之一
  - 交换矩阵的任意两行
  - 用一个非零的标量乘以任意一行
  - 将任意一行的数倍加到另外一行
- **定义 4**：一个矩阵当且仅当满足以下条件时，才可称为简约矩阵
  - 对所有的非零行，左面第一个元素也称首元，为 1
  - 所有非零行都位于零行的前面，也就是说，所有的零行位于矩阵的底部
  - 如果一行的首元位于第 $j$ 列，则其他行的第 $j$ 列不存在非零元素
  - 任意两个非零行 $i_1$ 和 $i_2$，若 $i_2 \gt i_1$，则分别包含这两行首元的 $j_1$ 和 $j_2$ 列一定满足 $j_2 \gt j_1$
- **算法 5**：该算法将线性方程组对应的 $n\times(n+1)$ 增广矩阵 $M$，变换为简约矩阵。在每一步中，$M$ 为矩阵的当前状态而不是原始状态
  - (a) 令行号 $i=1$
  - (b) 令列号 $j=1$，从第 $1$ 列到第 $n$ 列开始循环
  - (c) 找到第 $k$ 行，$k\ge i$，使 $M_{kj}$ 的绝对值最大，如果不存在 $M_{kj}\neq 0$ 的行，则跳到步骤 (h)
  - (d) 如果 $k\neq i$，则利用初等行变换交换第 $k$ 行 和第 $i$ 行
  - (e) 利用初等行变换给第 $i$ 行每个元素乘以 $1/{M_{ij}}$，使矩阵 $M$ 的 $(i,j)$ 元素为 $1$
  - (f) 利用初等行变换，对于每行 $r$，$1\le r\le n$ 且 $r\neq i$，将第 $i$ 行的 $-M_{rj}$ 倍加到第 $r$ 行，该步骤将第 $j$ 列中位于第 $i$ 行上面和下面的全部元素变成 $0$
  - (g) $i$ 加 $1$
  - (h) 如果 $j\lt n$，$j$ 加 $1$，并且跳到步骤 (c)
  - 步骤 (c) 和 (d) 称为主元选择，可以去除矩阵主对角线上的 0 元素，是保证初等变换的数值稳定性的基础
- 系数矩阵的简约矩阵为单位矩阵时，线性方程组有唯一解；简约矩阵有一行或多行为 0 时，线性方程组无解或有无穷多个解
- 齐次线性方程组至少有一个 $\overrightarrow{0}$ 向量解。仅当简约系数矩阵存在至少一个 0 行时，齐次线性方程组存在非平凡解
  - 非平凡解是齐次方程或齐次方程组的非零解

## 逆矩阵

- 对任意 $n\times n$ 矩阵 $M$，如果存在一个矩阵 $M^{-1}$，使 $MM^{-1}=M^{-1}M=I$，则称矩阵 $M$ 可逆，矩阵 $M^{-1}$ 称为矩阵 $M$ 的逆矩阵
- 没有逆矩阵的矩阵称为奇异矩阵
- **定理 6**：包含 0 行或者 0 列的矩阵不可逆
- **定理 7**：当且仅当矩阵 $M^T$ 可逆，矩阵 $M$ 可逆
- **定理 8**：如果 $n\times n$ 矩阵 $F$ 和 $G$ 是可逆矩阵，则它们的积 $FG$ 也可逆，且 $(FG)^{-1}=G^{-1}F^{-1}$
- **算法 9**：Gauss-Jordan 消去法。该算法可计算 $n\times n$ 矩阵 $M$ 的逆矩阵
  - (a) 构造增广矩阵 $\widetilde{M}$，在本算法中，每一步中的 $\widetilde{M}$ 为矩阵的当前状态，而不是原始状态

    $$
    \widetilde{M}=\left [
    \begin{array}{c:c}
    \begin{matrix}
    M_{11} & M_{12} & \dots & M_{1n} \\
    M_{21} & M_{22} & \dots & M_{2n} \\
    \vdots & \vdots & \ddots & \vdots \\
    M_{n1} & M_{n2} & \dots & M_{nn}
    \end{matrix}&
    \begin{matrix}
    1 & 0 & \dots & 0 \\
    0 & 1 & \dots & 0 \\
    \vdots & \vdots & \ddots & \vdots \\
    0 & 0 & \dots & 1
    \end{matrix}
    \end{array}
    \right ]
    $$

  - (b) 令列号 $j=1$，从第 $1$ 列到第 $n$ 列开始循环
  - (c) 找到第 $i$ 行，$i\ge j$，使 $\widetilde{M}$ 的绝对值最大，如果不存在 $\widetilde{M}\neq 0$ 的行，则矩阵 $M$ 不可逆
  - (d) 如果 $i\neq j$，则利用初等行变换交换第 $i$ 行和第 $j$ 行
  - (e) 利用初等行变换给第 $j$ 行每个元素乘以 $1/{\widetilde{M}_{ij}}$，使矩阵 $\widetilde{M}$ 的 $(i,j)$ 元素为 $1$
  - (f) 利用初等行变换，对于每行 $r$，$1\le r\le n$ 且 $r\neq j$，将第 $j$ 行的 $-\widetilde{M}_{rj}$ 倍加到第 $r$ 行，该步骤将第 $j$ 列中位于第 $j$ 行上面和下面的全部元素变成 $0$
  - (g) 如果 $j\lt n$，$j$ 加 $1$，并且跳到步骤 (c)
  - 算法的思想是将左边的 $n\times n$ 矩阵变成单位矩阵，这时矩阵 $\widetilde{M}$ 右边的 $n\times n$ 矩阵就是矩阵 $M$ 的逆矩阵，实现比较简单，且可以判断一个矩阵是否可逆
- **定理 10**：令矩阵 $M'$ 是 $n\times n$ 矩阵 $M$ 经过初等行变换得到的 $n\times n$ 矩阵，则 $M'=EM$，其中 $E$ 是单位矩阵经过相同的初等行变换得到的 $n\times n$ 矩阵
  - 该定理可以证明算法 9 得到的矩阵为原来矩阵的逆矩阵
- 单位矩阵经过初等行变换得到的 $n\times n$ 矩阵 $E$ 被称为初等矩阵。如果将矩阵 $M$ 变成相应的单位矩阵，需要 $k$ 个初等行变换，则

  $$
  I=E_kE_{k-1}\cdots E_1M
  $$

  - 其中，$E_1,E_2,\cdots E_k$ 是与单位矩阵的 $k$ 个初等行变换对应的初等矩阵，它们的乘积 $E_kE_{k-1}\cdots E_1$ 等于矩阵 $M$ 的逆矩阵
- **定理 11**：当且仅当 $n\times n$ 矩阵 $M$ 的行向量形成线性无关的向量集合时，矩阵 $M$ 可逆

## 行列式

- 方阵的行列式是从矩阵元素导出的一个标量，矩阵 $M$ 的行列式可表示为 $\det{M}$

  $$
  \det{M}=\left|\begin{matrix}
  M_{11} & M_{12} & \dots & M_{1m} \\
  M_{21} & M_{22} & \dots & M_{2m} \\
  \vdots & \vdots & \ddots & \vdots \\
  M_{n1} & M_{n2} & \dots & M_{nm}
  \end{matrix}\right|
  $$

- 为了便于表示，用符号 $M^{\{i,j\}}$ 表示原矩阵 $M$ 中去除第 $i$ 行和第 $j$ 列后，剩余的 $(n-1)\times (n-1)$ 矩阵
- **定义 12**：令 $M$ 为 $n\times n$ 矩阵，矩阵元素 $M^{\{i,j\}}$ 的代数余子式 $C_{ij}(M)$ 的定义如下

  $$
  C_{ij}(M)=(-1)^{i+j}\det{M^{\{i,j\}}}
  $$

  - 约定 $1\times 1$ 矩阵的行列式就是该矩阵唯一的元素，$n\times n$ 矩阵 $M$ 的行列式为

    $$
    \det{M}=\sum_{i=1}^nM_{ik}C_{ik}(M)
    $$
    或
    $$
    \det{M}=\sum_{j=1}^nM_{kj}C_{kj}(M)
    $$
  
  - 其中，$k$ 为 $1\le k\le n$ 的任一常数，无论 $k$ 为何值，以上两个公式计算出的行列式的值相同
- **定理 13**：矩阵的初等行变换对矩阵行列式影响如下
  - 交换矩阵的两行，使行列式变号
  - 给矩阵的某一行乘以标量 a，等于行列式也乘以 a
  - 将矩阵的某一行的数倍加到其他行上，行列式的值不变
- **推论 14**：具有两个相同行的矩阵的行列式为 0
- 对于任意 $n\times n$ 矩阵 $M$，如果 $E$ 是一个 $n\times n$ 初等矩阵，则 $\det{EM}=\det{E}\det{M}$，这是因为给矩阵 $M$ 乘以矩阵 $E$ 相当于对 $M$ 进行相应的初等行变换
- **定理 15**：当且仅当 $\det{M}\neq 0$ 时，$n\times n$ 矩阵 $M$ 可逆
- **定理 16**：对于任意两个 $n\times n$ 矩阵 $F$ 和 $G$，$\det{FG}=\det{F}\det{G}$
- **定理 17**：令 $F$ 为 $n\times n$ 矩阵，另外一个 $n\times n$ 矩阵 $G$ 的元素定义如下

  $$
  G_{ij}=\frac{C_{ji}(F)}{\det{F}}
  $$

  - 其中，$C_{ji}(F)$ 是 $(F^T)_{ij}$ 的代数余子式，则 $G=F^{-1}$

## 特征值和特征向量

- 对于 $n\times n$ 矩阵 $M$，存在一个非 0 的 n 维向量 $V_1,V_2,\cdots,V_n$ 使下式成立

  $$
  MV_i=\lambda_iV_i
  $$

  - 其中，比例系数 $\lambda_i$ 称为矩阵 $M$ 的特征值，向量 $V_i$ 称为该特征值对应的特征向量
- 通过解方程可得特征值 $\lambda_i$

  $$
  \det{(M-\lambda_iI)}=0
  $$

- 可以通过下式根据已知的特征值获得对应的特征向量

  $$
  (M-\lambda_iI)V_i=\overrightarrow{0}
  $$

  - 如果 $V_i$ 是与特征值 $\lambda_i$ 对应的特征向量，则其与标量的乘积 $aV_i$ 也是特征向量，$a$ 可以是任意非 0 常数，如果需要，特征向量可以写成单位长度为 1 的形式
- **定义 18**：对于 $n\times n$ 矩阵 $M$ 来说，当且仅当，对任意的 $i$ 和 $j$，有 $M_{ij}=M_{ji}$，则该矩阵 $M$ 为对称矩阵。也就是说，一个矩阵的元素相对主对角线对称，则该矩阵为对称矩阵
- **定理 19**：由实数元素组成的对称矩阵 $M$ 的特征值为实数
- **定理 20**：对称矩阵 $M$ 的两个不同特征值分别对应的特征向量正交

## 矩阵对角化

- 对角矩阵是指只有主对角线上含有非零元素的矩阵
- 如果存在一个矩阵 $A$，使 $A^{-1}MA$ 的结果为对角矩阵，则称矩阵 $A$ 将矩阵 $M$ 对角化
- **定理 21**：令 $M$ 为 $n\times n$ 矩阵，其特征值为 $\lambda_1,\lambda_2,\cdots,\lambda_n$，特征向量为 $V_1,V_2,\cdots,V_n$，形成线性无关集合，以每个特征向量为列构成矩阵 $A$，如下所示

  $$
  A=\begin{bmatrix}V_1 & V_2 & \cdots & V_n\end{bmatrix}
  $$

  - 矩阵 $A$ 可以将矩阵 $M$ 对角化，乘积矩阵 $A^{-1}MA$ 的主对角线元素是矩阵 $M$ 的特征值

    $$
    A^{-1}MA=\begin{bmatrix}
    \lambda_1 & 0 & \dots & 0 \\
    0 & \lambda_2 & \dots & 0 \\
    \vdots & \vdots & \ddots & \vdots \\
    0 & 0 & \dots & \lambda_n
    \end{bmatrix}
    $$

  - 反之，如果存在可逆矩阵 $A$，使 $A^{-1}MA$ 为对角矩阵，则矩阵 $A$ 的列等于矩阵 $M$ 的特征向量，$A^{-1}MA$ 的主对角线元素为矩阵 $M$ 的特征值
- 由于对称矩阵 $M$ 的特征向量是正交的，则以 $M$ 的单位长度的特征向量为列构成的矩阵 $A$ 是正交矩阵，$A^{-1}=A^T$
